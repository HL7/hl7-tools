<p id="notice"><%= notice %></p>

<% content_for :title, @tool.name %>

<p>
  <% if @tool.url -%>
      <%= link_to 'Tool Homepage', @tool.url %>
  <% else -%>
      <span class="comment">No homepage specified</span>
  <% end -%>
  <% if @tool.support_url -%>
  &nbsp;&nbsp;&nbsp;&nbsp;<%= link_to 'Tool Issues', @tool.support_url %>
  <% end -%>
</p>

<% unless @tool.active -%>
<p class="important-notice">This tool is not active</p>
<% end -%>
<p>
  <%= @tool.description %>
</p>

<p>
  <strong>Purpose:</strong>
  <%= @tool.purpose %>
</p>

<% if @tool.aka -%>
    <p>
      <strong>Also Known As:</strong>
      <%= @tool.aka %>
    </p>
<% end -%>
<p>
  <strong>Product Family:</strong>
<% if @tool.product_tags.count > 0 -%>
  <ul class="tag-list">
    <% @tool.product_tags.each do |tag| -%>
    <li><%= tag %></li>
    <% end -%>
  </ul>
<% end -%>
</p>

<p>
  <strong>HL7 Functional Areas:</strong>
<% if @tool.functional_tags.count > 0 -%>
  <ul class="tag-list">
    <% @tool.functional_tags.each do |tag| -%>
    <li><%= tag %></li>
    <% end -%>
  </ul>
<% end -%>
</p>

<p><strong>Technologies:</strong></p>
<ul>
  <% @tool.tool_technologies.each do |tech| -%>
  <li><%= tech.tech_code_value.print_name %> <%= tech.tech_version %></li>
  <% end -%>
</ul>

<p><strong>Dependencies:</strong></p>
<ul>
  <% @tool.tool_dependencies.each do |depend| -%>
      <li><strong><%= depend.dependency.name %></strong> <%= depend.note %></li>
  <% end -%>
</ul>

<table>
  <thead>
  <tr>
    <th>Version</th>
    <th>Rollout Date</th>
    <th>Last Update</th>
    <th>License</th>
  </tr>
  </thead>

  <tbody>
  <tr>
    <td><%= @tool.version %></td>
    <td><%= @tool.rollout_date %></td>
    <td><%= @tool.last_update_date %></td>
    <td><%= (@tool.license_name ? @tool.license_name : 'unspecified')  %></td>
  </tr>
  </tbody>
</table>

<% if @tool.active && @tool.tool_assessments.count > 0 -%>
    <% assess = @tool.last_assessment -%>
<p><strong>Assessment:</strong> (done: <%= assess.assessment_date %>)</p>
<div class="meter-container">
  <section class="vertical-meter">
    <input id="risk" disabled="true" type='range' min='0' max='100' step='5' value='<%= assess.risk %>' orient="vertical"/>
  </section>
  <section class="vertical-meter">
    <input disabled="true" type='range' min='0' max='100' step='5' value='<%= assess.quality %>'/>
  </section>
  <section class="vertical-meter">
    <input disabled="true" type='range' min='0' max='100' step='5' value='<%= assess.sustainability %>'/>
  </section>
  <section class="vertical-meter">
    <input disabled="true" type='range' min='0' max='100' step='5' value='<%= assess.usability %>'/>
  </section>
</div>
<% end -%>

<p><strong>People and Organizations associated with <%= @tool.name %>:</strong></p>
<% if @tool.tool_persons.count > 0 -%>
<ul>
<% @tool.tool_persons.each do |person| -%>
  <li>
    <p>
    <%= person.person_org.name %>
      -<%= person.role_code_value.print_name %>-
      <% if person.person_org.contact_phone || person.person_org.contact_email -%>
      (<%= person.person_org.contact_phone ? person.person_org.contact_phone : '' %>
      <%= person.person_org.contact_phone && person.person_org.contact_email ? ' | ' : '' %>
          <%= person.person_org.contact_email %>)
      <% end -%>
    </p>
  </li>
<% end -%>
</ul>
<% else -%>
    <p>none identified</p>
<% end -%>
<% if @tool.tool_notes.count > 0 -%>
<p>
  <strong>Notes:</strong>
  <ul>
    <% @tool.tool_notes.each do |note| -%>
    <li class="note">
      <p>
        <span class="note-date"><%= note.note_date %></span>
        (<span class="note-author"><%= note.author %></span>)
        <%= note.note %>
      </p>
    </li>
    <% end -%>
  </ul>
</p>
<% end -%>

<% if @tool.tool_users.count > 0 -%>
<p>
  <strong>Known Users of the <%= @tool.name %></strong>
  <ul>
    <% @tool.tool_users.each do |user| -%>
    <li><% if user.is_link? -%>
          <%= link_to 'external users list', user.external_list %>
        <% else -%>
          <%= user.name_of_user %>
        <% end -%></li>
    <% end -%>
  </ul>
</p>
<% end -%>

<% if is_admin? %><%= link_to 'Edit', edit_tool_path(@tool) %> |<% end %>
<%= link_to 'Back', tools_path %>

